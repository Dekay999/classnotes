\documentclass[12pt,fleqn]{article}\usepackage{../../common}
\begin{document}
Çift Sarkaç (Double Pendulum)

En basit formunda çifte sarkaç $L_1,L_2$ uzunluðunda kütlesiz iki çubuk, iki
$m_1,m_2$ kütlesindeki iki topu birleþtirir ve sallandýrýr. Eðer $m_1$'in
olduðu kordinatlarý $x_1,y_1$, $m_2$ kütlesini $x_2,y_2$ ile belirtirsek,

\includegraphics[width=15em]{phy_dblpend_01.png}

$$
x_1 = L_1 \sin\theta_1
$$

$$
y_1 = - L_1 \cos\theta_1
$$

$$
x_2 = L_2  (\sin\theta_1 +  \sin\theta_2) 
$$

$$
y_2 = -L_2  (\cos\theta_1 + \cos \theta_2)
$$

Mesela $y_1$ için $- L_1 \cos\theta_1$ olmasýnýn sebebi kordinat
bakýmýndan aþaðý doðru gidiyor olmamýz. 

Sistemin Lagrangian'ýný hesaplayacaðýz, $L = K - P$. 

Kinetik enerji $K$ hesabýný $\frac{1}{2} m v^2$ üzerinden yapabiliriz, ve
$v$ bileþenlerini yatay, dikey üzerinden düþünürsek,
$v = \sqrt{v_x^2 + v_y^2}$ ya da $v^2 = v_x^2 + v_y^2$, ve üstteki örnekte
hýz kütle \#1 için $\dot{x}_1$ kütle \#2 için $\dot{x}_2$. O zaman

$$
K = \frac{1}{2} m_1 ( \dot{x}_1 ^2 + \dot{y}_1 ^2 )  + m_2 ( \dot{x}_2 ^2 + \dot{y}_2 ^2 ) 
$$

Açmak için $\dot{x}_1, \dot{x}_2$, vs bulunmalý, üstteki $x_1$'in $t$
üzerinden türevini almak lazým yani, hepsini yapinca,

$$
\dot{x}_1 = L_1 \cos^2(\theta_1)\dot{\theta_1}
$$

$$
\dot{y}_1 = L_1 \sin(\theta_1)\dot{\theta_1}
$$

$$
\dot{x}_2 = L_1 \cos(\theta_1)\dot{\theta}_1 + L_2 \cos (\theta_2)\dot{\theta}_2
$$

$$
\dot{y}_2 = L_1 \sin(\theta_1)\dot{\theta}_1 + L_2 \sin(\theta_2)\dot{\theta}_2
$$

$$
K = 
1/2 m_1 \dot{\theta}_1^2 L_1^2 + 
1/2 m_2 [
 \dot{\theta}_1^2 L_1^2 + \dot{\theta}_2^2 L_2^2  + 
 2 \dot{\theta}_1^2 L_1 \dot{\theta}_1L_2\cos(\theta_1 - \theta_2)]
$$

Potansiyel enerjiye gelelim, tek sarkaçtan $m g h$ formülü en yüksek
noktada en fazla potansiyel enerji verir. Bir kordinat sisteminde kütle
\#1'ýn sabitlendiði noktaya orijin dedik, o zaman en alt noktada enerji en
azdir. Fakat mesela $L_1$ negatif, pozitifsel durumu bunlarý idare eder
zaten, biz direk formülü yazarsak,

$$
P = m g y_1 + m g y_2
$$

Sadece dikey kordinat kullanýldý çünkü potansiyel enerji üzerinde tek
etkili olan dikey kordinattýr. 

$$
P = -m_1 g L_1 \cos(\theta_1) - m_2 g (L_1 \cos(\theta_1) + L_2 \cos(\theta_2))
$$

Lagrangian $L = K - P$'yi elde etmek icin 

$$
L = 
\frac{1}{2} m_1 (\dot{\theta}_1 L_1)^2 + 
\frac{1}{2} m_2 [(\dot{\theta}_1L_1)^2 + 
(\dot{\theta}_2 L_2 )^2  +  ..
$$
$$
 2 \dot{\theta}_1^2 L_1 \dot{\theta}_1L_2\cos(\theta_1 - \theta_2)] -
[-(m_1+m_2) g L_1 \cos(\theta_1) - m_2 L_2 g \cos(\theta_2)]
$$

Basitleþtirince

$$
L = \frac{1}{2} (m_1 + m_2) L_1^2 \dot{\theta}_1^2 + 
\frac{1}{2} m_2 L_2^2 \dot{\theta}_2^2 + 
m_2 L_1 L_2 \dot{\theta}_1\dot{\theta}_2 \cos(\theta_1-\theta_2) + ..
$$
$$
(m_1 + m_2) g L_1 \cos(\theta_1) + m_2 L_2  g \cos(\theta_2)
$$

Bu sistemden bir fiziksel sistemi üretmek istiyorsam $L$'yi minimize edecek
fonksiyonlarý elde etmem lazým. Burada bir deðiþimsel calculus problemi
var, yani Euler-Lagrange denklemlerine bakabilirim. 

$$
\frac{\ud}{\ud t} \left(
\frac{\partial L}{\partial \dot{\theta}} 
\right) -
\frac{\partial L}{\partial \theta} = 0
$$

Her $\theta_1,\theta_2$ için üstteki denklemi kullanacaðým, ve elde ettiðim
formüller bu sistemin dinamik formülleri olacaklar. 

$\theta_1$ icin

$$
\frac{\partial L}{\partial \theta_1} = 
-L_1 g (m_1 + m_2) \sin(\theta_1) - m_2 L_1 L_2 \dot{\theta}_1\dot{\theta_2}\sin(\theta_1-\theta_2)
$$

$$
\frac{\partial L}{\partial \dot{\theta}_1} = 
(m_1 + m_2) L_1^2 \dot{\theta}_1 + m_2 L_1 L_2 \dot{\theta}_2 \cos(\theta_1- \theta_2)
$$
 
$$
\frac{\ud }{\ud t} \left(
\frac{\partial L}{\partial \dot{\theta}_1} \right) = 
(m_1 + m_2) L_1^2 \ddot{\theta}_1 + m_2 L_1 L_2 \ddot{\theta}_2 \cos(\theta_1-\theta_2)-
m_2 L_1 L_2 \dot{\theta}_2 \sin(\theta_1-\theta_2)(\dot{\theta}_1 - \dot{\theta}_2)
$$

Üsttekileri bir araya koyup herþeyi $L_1$ ile bölersek,

$$
\Rightarrow (m_1 + m_2) L_1 \ddot{\theta}_1 + 
m_2 L_2 \ddot{\theta}_2 \cos(\theta_1-\theta_2)-
$$
$$
m_2 L_2 \dot{\theta}_2 \sin(\theta_1-\theta_2)(\dot{\theta}_1 - \dot{\theta}_2) +
g (m_1 + m_2) \sin(\theta_1) + 
m_2 L_2 \dot{\theta}_1\dot{\theta_2}\sin(\theta_1-\theta_2)=0
$$

$$
\Rightarrow (m_1 + m_2) L_1 \ddot{\theta}_1 + 
m_2 L_2 \ddot{\theta}_2 \cos(\theta_1-\theta_2) +
g (m_1 + m_2) \sin(\theta_1) + 
$$
$$
m_2 L_2\dot{\theta}_2 \sin(\theta_1-\theta_2) \left[ (\dot{\theta}_1 - \dot{\theta}_1 + \dot{\theta}_2)  \right]
=0
$$

$$
\frac{\ud}{\ud t} \left(
\frac{\partial L}{\partial \dot{\theta_1}} 
\right) - \frac{\partial L}{\partial \theta_1} =  (m_1 + m_2) L_1 \ddot{\theta}_1 + 
m_2 L_2 \ddot{\theta}_2 \cos(\theta_1-\theta_2) +
g (m_1 + m_2) \sin(\theta_1) + 
$$
$$
m_2 L_2\dot{\theta}_2^2 \sin(\theta_1-\theta_2) 
=0
$$








[devam edecek]

\begin{minted}[fontsize=\footnotesize]{python}
import math, pylab
import numpy as np
from matplotlib.patches import Circle
import matplotlib.pyplot as plt

g = 9.8 # standard freefall (m/s^2)

l = 1
L1 = 1
L2 = 1
theta10 = 3*np.pi/7
theta20 = 3*np.pi/4
dt = 0.01
tmax = 10

nsteps = int(tmax/dt)
t = [0.0]*nsteps
p1 = [0.0]*nsteps
p2 = [0.0]*nsteps
q1 = [0.0]*nsteps
q2 = [0.0]*nsteps
x1 = [0.0]*nsteps
x2 = [0.0]*nsteps
y1 = [0.0]*nsteps
y2 = [0.0]*nsteps

# initialize
q1[0] = theta10                              
q2[0] = theta20                              
x1[0] = l*math.sin(q1[0])                    
y1[0] = - l*math.cos(q1[0])                  
x2[0] = l*(math.sin(q1[0])+math.sin(q2[0]))  
y2[0] = - l*(math.cos(q1[0])+math.cos(q2[0]))

# use Euler-Cromer method to integrate the double pendulum
for i in range(nsteps - 1):
    s = math.sin(q1[i] - q2[i])                               
    c = math.cos(q1[i] - q2[i])                               
    D = l**2*(1+s**2)                                         
    A = p1[i]*p2[i]*s/D                                       
    B = (p1[i]**2+2*p2[i]**2 - 2*p1[i]*p2[i]*c)*s*c*l**2/D**2 

    p1[i+1] = p1[i] - (2*g*l*math.sin(q1[i]) - A+B)*dt
    p2[i+1] = p2[i] - (g*l*math.sin(q2[i])+A - B)*dt
    q1[i+1] = q1[i]+(p1[i+1] - p2[i+1]*c)/D*dt
    q2[i+1] = q2[i]+(2*p2[i+1] - p1[i+1]*c)/D*dt
    t[i+1] = t[i]+dt

    # put q1 and q2 in range -pi to +pi
    q1[i+1] = (q1[i+1]+math.pi)%(2.0*math.pi) - math.pi
    q2[i+1] = (q2[i+1]+math.pi)%(2.0*math.pi) - math.pi
    
    # also compute (x,y) locations of points 1 and 2
    x1[i+1] = l*math.sin(q1[i+1])                       
    y1[i+1] = - l*math.cos(q1[i+1])                     
    x2[i+1] = l*(math.sin(q1[i+1])+math.sin(q2[i+1]))   
    y2[i+1] = -  l*(math.cos(q1[i+1])+math.cos(q2[i+1]))

# Plotted bob circle radius
r = 0.05
# Plot a trail of the m2 bob's position for the last trail_secs seconds.
trail_secs = 0
# This corresponds to max_trail time points.
max_trail = int(trail_secs / dt)

def make_plot(i):
    # Plot and save an image of the double pendulum configuration for time
    # point i.
    # The pendulum rods.
    ax.plot([0, x1[i], x2[i]], [0, y1[i], y2[i]], lw=2, c='k')
    # Circles representing the anchor point of rod 1, and bobs 1 and 2.
    c0 = Circle((0, 0), r/2, fc='k', zorder=10)
    c1 = Circle((x1[i], y1[i]), r, fc='b', ec='b', zorder=10)
    c2 = Circle((x2[i], y2[i]), r, fc='r', ec='r', zorder=10)
    ax.add_patch(c0)
    ax.add_patch(c1)
    ax.add_patch(c2)

    # The trail will be divided into ns segments and plotted as a fading line.
    ns = 20
    s = max_trail // ns

    for j in range(ns):
        imin = i - (ns-j)*s
        if imin < 0:
            continue
        imax = imin + s + 1
        # The fading looks better if we square the fractional length along the
        # trail.
        alpha = (j/ns)**2
        ax.plot(x2[imin:imax], y2[imin:imax], c='r', solid_capstyle='butt',
                lw=2, alpha=alpha)

    # Centre the image on the fixed anchor point, and ensure the axes are equal
    ax.set_xlim(-L1-L2-r, L1+L2+r)
    ax.set_ylim(-L1-L2-r, L1+L2+r)
    ax.set_aspect('equal', adjustable='box')
    plt.axis('off')
    plt.savefig('/home/burak/Downloads/frames/img{:04d}.png'.format(i), dpi=72)
    plt.cla()

    
fps = 10
di = int(1/fps/dt)
fig = plt.figure(figsize=(8.3333, 6.25), dpi=72)
ax = fig.add_subplot(111)
tmax, dt = 30, 0.01
t = np.arange(0, tmax+dt, dt)
for i in range(0, t.size, di):
    if i==1000: break
    if i % 20 == 0:
        print (i)
        make_plot(i)
\end{minted}


\begin{minted}[fontsize=\footnotesize]{python}
! convert -loop 0 -delay 100 frames/*.png frames/dblpend.gif
\end{minted}








Kaynaklar

[1] Altic, \url{sophia.dtp.fmph.uniba.sk/~kovacik/doublePendulum.pdf}

[2] Bayramli, {\em Double Pendulum Animasyonu}, \url{https://github.com/burakbayramli/classnotes/blob/master/phy/phy_dblpend/frames/dblpend.gif}

[3] \url{http://galileo.phys.virginia.edu/education/outreach/8thgradesol/EnergyPendulum.htm}

[4] Altic, \url{https://mse.redwoods.edu/darnold/math55/DEproj/sp08/jaltic/ProjectTitleOnline.pdf}

\end{document}

