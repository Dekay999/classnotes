\documentclass[12pt,fleqn]{article}\usepackage{../../common}
\begin{document}
Daha Az Kumandalý Robotlar - 3

Önceki derste gayrý-lineer dinamikten bahsettik, faz grafiklerine baktýk,
çekim bölgesine (basýn of attraction) baktýk, sabit noktalara baktýk..
Kontrol konusuna hafifçe dokunduk ve bu konuya iþaret ederken onu bir takým
matris denklemlerinin manipülasyonu olarak deðil, faz grafikleriyle
alakalandýrmaya uðraþtým, öyle ki kontrol demek bu faz grafiklerini
deðiþtirmek, onlarý hareket ettirmek demek oluyordu, sistemi kendi
istediðiniz noktaya kanalize etmek için grafiði (sistemi) tekrar
þekillendirmiþ, eðip, bükmüþ oluyorduk. Tabii biraz eðmekten bahsediyoruz,
bu derste çok fazla eðme bükme yapmýyoruz [1]. 

Ýlk bakacaðýmýz örnek çift entegratör, $\ddot{q} = u$. Bu örnekte herþeyi
analitik olarak yapabilirim. Bu denklemin fiziksel karþýlýðýný düþünmek
istersek, buz üzerinde duran birim kütlede bir tuðla düþünebiliriz. Tuðlaya
uygulanan kontrol kuvveti $F = u$, sürtünme yok. 

\includegraphics[width=10em]{phy_control_01.png}

[Dikkat hem kordinat üzerinde hem de konumsal deðiþken olarak $x$
kullanýlmýþ, karýþýklýk olmasýn] 

Bu çift entegratör ile yapmak istediðimiz onu orijin noktasýna ve sýfýr
hýza getirmek. Bariz olmayabilir ama bunu yapmanýn pek çok yolu var ve
bizim amacýmýz bu iþi yaparken bir tür optimallik kriterine uyarak onu
yapmak. Derslerimizin geri kalan tümünde optimallik kriteri bizim için bir
tür hesapsal baston görevini görecek.

Ýlk önce kutup yerleþtirme (pole placement) analiziyle baþlamak
istiyorum. Sistemi durum uzay (state space) formatýnda yazalým. Durum için
çoðunlukla $x$, kordinat için $q$ kullanýlýr, altta solda görülüyor. Altta
saðda durum uzay dinamiðidir, genel bir sistemi tarif ediyor,

$$ 
x = \left[\begin{array}{c} q \\ \dot{q}  \end{array}\right] \quad
\dot{x} = A x + Bu
$$

O zaman üstteki en basit sistemi tarif etmek için

$$ 
\dot{x} = \left[\begin{array}{rr}
0 & 1 \\ 0 & 0
\end{array}\right] x + 
\left[\begin{array}{c} 0 \\ 1 \end{array}\right] u
$$

Verili $A,B$ ile açýlýmý yapýnca çift entegratör sistemini elde ettiðimizi
göreceðiz.

Amacýmýz $u$'yu bulmaktý deðil mi, tuðla üzerinde etki eden öyle bir
kontrol eylemi $u = \pi(x)$ bulalým ki sistemi sýfýr noktasýna
getirsin. Yani amacýmýz bir geri besleme kanunu $\pi$ bulmak ($\pi$
sembolünü $x$'in fonksiyonu olan kontrol ilkeleri için kullanýyorum). Þu
formdaki $u$'lar ile baþlayabiliriz; $u = -K x$.  $K$ bir matris, $x$
alýnýyor ve $-K$ ile ölçekleniyor. Bu örnekte $K$ matrisi 1x2 boyutunda,
$\left[\begin{array}{cc} k_1 & k_2 \end{array}\right]$,

$$ 
-K x = 
\left[\begin{array}{cc} k_1 & k_2 \end{array}\right] 
\cdot
\left[\begin{array}{cc} q \\ \dot{q} \end{array}\right] =
-k_1 q - k_2 \dot{q}
$$

Bazýlarýmýz bir formu orantýlý türevsel kontrolör olarak tanýyacaktýr. 

Þimdi $K$'yi deðiþtirince sistemime ne olacak diye düþünüyorum, bu hesap
lineer sistemlerde kolay, $u = -Kx$'i denkleme geri sokarsam 

$$ 
\dot{x} = (A - BK)x = \left[\begin{array}{rr}
0 & 1 \\ -k_1 & -k_2
\end{array}\right] x
$$

elde ederim. Diferansiyel denklemler dersi alanlar üstteki denklemi nasýl
çözeceðimizi bilir, çözüm sistemin özdeðerlerini kullanýr, üstteki matrisin
özdeðerlerini hesaplarýz, sonra özvektörler $v_1,v_2$'yi buluruz,

$$ 
\lambda_{1,2} = \frac{-k_2 \pm \sqrt{k_2^2 - 4 k_1}}{2}, \quad
v_1 = \left[\begin{array}{r}
1 \\ \lambda_1
\end{array}\right], \quad 
v_2 = \left[\begin{array}{r}
1 \\ \lambda_2
\end{array}\right]
$$

Peki sistemin stabil olmasý için özdeðelerin belli deðerlerde olmasý
gerekiyor deðil mi? Ýkisinin de negatif olmasý. Sistemde salýným olup
olmadýðýný merak ediyoruz, bu durum kompleks özdeðerler varsa olur, ki bu
durum üstteki karekök içinde eksi deðer varsa ortaya çýkar, onun olmasý
için de $4 k_1$ deðeri $k_2^2$ olmalý. 

Biz salýným istemiyoruz, $4 k_1 > k_2^2$, bu durumda sistem aþýrý sönümlu,
$4 k_1 = k_2^2$ ise kritik sönümlu, $4 k_1 < k_2^2$ ise eksik sönümlu,
ayrýca stabilite için $\lambda_{1,2} < 0$ olmalý.

Bu sonuçlarý faz grafiklerine baðlayalým; özdeðer ayrýþtýrmasý yapmamýzýn
bir diðer sebebi sistemi çok güzel grafiksel þekilde yorumlamamýza izin
vermesi. Spesifik bir duruma bakalým, $k_1 = 1$, ve aþýrý sönümlu bir
sistem için $k_2$ en az 2 olmalý, onu $k_2 = 4$ yapayým. Özdeðerler bu
durumda  

$$
\lambda_{1,2} =  \frac{-4 \pm \sqrt{16-4}}{2} =
-2 \pm 3 
$$

$$
\lambda_1 = 0.25, \lambda_2 = -3.75
$$
 
Þimdi durum uzay grafiðini çizebilirim, $q,\dot{q}$ kordinat sisteminde,
ilk önce $-0.25$ eðiminde $v_1$ bir çizgisi çizerim,  sonra kabaca $-4$
eðiminde bir çizgi daha çizerim, $v_2$. Sonumlu sistemdeyiz, bu yüzden
çizgilerdeki oklar dýþarýdan içeri doðru. 

\includegraphics[width=20em]{phy_control_02.png}

Bu arada anlatým açýsýndan, ve birkaç tane grafik çizmemek için aþýrý
sönümlü sistem seçtim, böylece tekrarlanan özdeðer çýkmadý, yani salýným
olmadý. Ama aþýrý sönümlü sistem konuyu irdelemek için yine de iyi çünkü
tekrarlanan özdeðer olmayýnca özvektörler uzayý kapsar (span). Ya da, her
baþlangýç konumu iki özvektörün lineer kombinasyonu olarak yazýlabilir.

$$
x(0) = \alpha_1 v_1 + \alpha_2 v_2
$$

gibi, ki $\alpha_{1,2}$ bir kombinasyonu oluþturacak herhangi iki
sabit. Nihai sistem ise 

$$ 
x(t) = \alpha_1 e^{\lambda_1 t}v_1  + \alpha_1 e^{\lambda_2 t} v_2
$$

Lineer sistemlerin güzel tarafý bu. Bu demektir ki özvektörleri
grafiklediðim zaman sistemýn tüm faz grafiðini biliyorum. Mesela altta
görülen baþlangýçtan $v_2$ çok hýzlý, $v_1$ biraz daha az hýzda bizi sýfýra
götürecek, bu ikisinin birleþimi sonucunda alttaki gibi bir gidiþ yolu
takip edilecektir.

\includegraphics[width=20em]{phy_control_03.png}

Kontrol konusuna gelelim. $k_1,k_2$'yi deðiþtirebiliyoruz, ve bu
parametreleri deðiþtirmek demek faz portresini deðiþtirmek demektir deðil
mi? Onlarý öyle deðiþtirmeliyim ki sistem istediðim þeyi yapsýn. Bu
deðiþimi, o deðiþimi yaratacak $k$'leri nasýl ortaya
çýkartmalýyým. Optimalliðe girmeden önce mesela $k_2^2$ $4k_1$'ten büyük
olduðu sürece salýnýma girmeyeceðimi biliyorum, bu iyi. O zaman niye
$k_{1,2}$'yi sonsuza çýkartmýyorum, hemen kut diye sonuç ulasayým? Bu baþka
problemler çýkartabilir, biriniz fazla enerji diyor, doðru. $k_{1,2}$
olmasa ne olurdu? O zaman $\dot{x} = Ax$ kalýr sadece bu sistem sadece
direk grafikte saða doðru gider. 

Biz bu basit sistemde optimal geri beslemeli kontrol hesaplayacaðýz. 

Katý bir kýsýtlama ekleyelim, $|u| < 1$, $u$'nun mutlak deðeri 1'den küçük
olsun. Bu pek çok þeyi deðiþtirir, biraz önceki lineer sistem analizim ise
yaramaz hale gelir mesela. Formülize ederken 

$$ 
u = sat(-Kx)
$$

diyebilirim, $sat$ ifadesi Ýngilizce satüration'dan (doygunluk) geliyor, -1
altý için -1, +1 üstü için +1 yapýyorum. Üstte görülen gidiþ yollarý hala
hafiften geçerli, hala orijine gideriz, ama yol biraz daha uzayabilir çünkü
kut diye inebilmek yerine daha ufak artýþlarla gitmek zorundayýz, ve hala
stabilliði kaybetmiyoruz. Ama katý kýsýtlýlýklarý iyi ayarlamam gerekiyor
ki yol da çok uzamasýn. 

Bu ayarý yapmanýn bir yolu optimal kontrol ile. Tek yolu deðil muhakkak,
bir yolu. Diyelim ki hayattaki tek amaçým orijine gidebileceðim en hýzlý
þekilde gitmek, ama $|u| \le 1$ kýsýtlamasýna tabiyim. Bu aslýnda ünlü
minimum zaman problemi, 

$\left[\begin{array}{cc} 0 & 0 \end{array}\right]^T$'a gidebildiðin kadar
çabuk git $|u| \le 1$ kýsýtlamasýna tabi olarak. Tabii hem $q=0$ hem de
$\dot{q}=0$, yani hýz da sýfýr olacak. Orijin derken yer ve hýzdan oluþan
kordinat sistemindeki ``orijinden'' bahsediyoruz. 

Soruya teorik olarak daha dalinca bu sorunun iyi sekillenmis olmasi icin
isitlamanin olmasi gerektigini de gorurduk, yoksa, daha once dedigim gibi,
sonsuz buyuklukte $u$ kullanabilirdim, sonsuz hizda ulasirdim ve birsey
ogrenmemis olurdum. 

Þimdi buz üzerinde tuðla hakkýnda zihnimizdeki tüm hayal gücü, bilgi
kýrýntýsýný kullanalým. Eðer sýnýrlý bir kuvvet uygulayabiliyorsam, ve
orijine en çabuk þekilde ulaþmak istiyorsam, ne yapmalýyým? Biriniz çat-çat
(bang-bang) dedi. Doðru. Ýleride bir yere mümkün olduðu kadar çabuk ulaþmak
istiyorsam çat diye gaza basarým hýzlanabildiðim kadar hýzlanýrým, sonra
belli bir kritik noktada çat diye frene baþarým ve yavaþlamaya baþlarým ve
kaya kaya hedef noktasýna geleceðim. Bundan daha iyisi mümkün deðil. Bunu
ispatlayacaðýz tabii. Bu cevabý çift entegratör olarak kafadan
düþünebilirdik, ama yürüyen bir robot için o kadar kolay düþünülemeyebilir,
ve biz cevabý genel bir altyapý üzerinden türetmeye uðraþacaðýz.

Bazen bazýlarýnýn ``cat-cat kontrol optimaldir'' dediðini duyabilirsiniz,
bu sonuç yapýcýlarýnýz (actuator) üzerinde katý sýnýrlar olduðu zaman sýkça
ortaya çýkar, ve bu sýnýrlar olduðu zaman o sýnýrlara en yakýn þekilde
davranmak her zaman daha iyidir (o yüzden cat diye hýzlanmak gerekli).
Robotlarda bu yaklaþým her zaman iþlemiyor, çünkü tek bir zaman aralýðýnda
yapýcýya maksimum kuvvet, sonra maksimum negatif kuvvet o durumda iyi
olmuyor.

Ýþin püf noktasý herhalde cat diye gaza bastýktan sonra ne zaman frene
geçeceðimizi bulmak deðil mi? Önce onu bulmaya uðraþalým, ortaya çýktýðý
sistem durumlarý herhalde birkaç tanedir. O durumlarý bulmaya
çalýþalým. $q>0$ durumuna bakalým önce, bir bölüm seçelim, bu durumda fren
$u=1$ deðil mi (gidiþ orijine doðru ise fren onun tersi yönde, yani pozitif
yönde olmalý)? O zaman alttaki formülü entegre edelim,

$$ 
\ddot{q}(t) = u = 1
$$

$$ 
\dot{q}(t) = u t + \dot{q}(0) \mlabel{1}
$$

Bir daha entegre

$$ 
q(t) = q(0) + \dot{q}(0) t + \frac{1}{2} u t^2 \mlabel{2}
$$

Formüle bakalým ve $u=1$ ile bizi bir nihai $t$'de $q(t)=0$ ve
$\dot{q}(t)=0$ götürecek hangi gidiþ yollarýnýn ortaya çýktýðýna bakalým. 

$\dot{q}(t)=0$ formülünü (1)'e sokarsak, 

$$
\dot{q}(0) = - u t \mlabel{3}
$$

Üstteki formülü (2)'ye sokarsak, ve $q(t)=0$ olduðu için (2) formülü

$$
q(0) = \frac{1}{2} ut^2 \mlabel{4}
$$

$t$ için çözelim, $u=1$ demiþtik, o zaman (3)

$$
t = -\dot{q}(0)
$$

olur. Ve üsttekini (4)'e koyarsak, ve yine $u=1$ ile

$$
q(0) = \frac{1}{2} \dot{q}(0)^2
$$

Bu sonucu konum uzayýnda grafiklersem bir sonuçlar manifoldu elde edeceðim.

\includegraphics[width=20em]{phy_control_04.png}

Sað üst köþe niye boþ, orada zaman eksi olmalý ama negatif zamana izin
yok. Sað alt köþede bir sürü çözümlerin oluþturduðu bir çizgi
görüyoruz. Diyelim çizginin sonunda frene basýyoruz, ve çizgi boyunca
yavaþlayýp yavaþlayýp orijine eriseceðiz (durmuþ olacaðýz). $-q$ durumu
için sol üstteki grafiði elde ediyoruz, orada $u=-1$.

Peki eðer karalanan yerlerden birinde isem mesela yeþil noktada ne yaparým?
Gösterilen manifold fren yapmanýn grafiði. Önce hýzlanýrým sonra fren
yaparým demiþtim deðil mi? O zaman yeþil noktadaysam yukarý çýkarým ve
grafiðe gelirim ve oradan frenler orijine eriþirim. 

\includegraphics[width=10em]{phy_control_05.png}

Eðer çizginin üstteki baþlýyorsam? O zaman manifolda paralel bir þekilde
aþaðý inerim, ve yukarý doðru ufak bir gidiþ yaparým. 

Göstermesi daha zor olan bunlarý yapmanýn optimal olduðunu
ispatlamak. Optimalliði ispatlayacaðýz çünkü bu optimallik daha genel
algoritmalarýn bazýný oluþturuyor. Optimalliði göstermek için dersimizin
ilk optimallik kavramýný göreceðiz.

Pontrayagin's Minimum Prensibi

Çoðunlukla optimal kontrol problemleri bir bedel fonksiyonu etrafýnda
formülize edilir. Bedel fonksiyonu tek sayý / skalar deðer döndüren bir
büyüklüktür, ve minimize etmek istediðim bu tek sayýdýr. Kullanacaðýmýz
notasyon þöyle olacak, 

$g(x,u)$: anlýk bedel 

$h(x)$: nihai bedel

$J(x)$: kalan bedel

Tekrar vurgulayalým, tüm bu fonksiyonlar skalar dönürüyor. 

Tipik bir kontrol problemi alttaki gibi formülize edilir, 

$$
J(x_0) = h(x(T)) + \int _{0}^{T} g(x,u) \ud t 
$$

öyle ki

$$
\dot{x}(t)=f(x,u), \quad x(0) = x_0
$$

Bu $J$ formülasyonu optimal kontrol için çok genel bir formülasyondur. Onu
bol bol kullanacaðýz. Formüle bakarsak mesela $g(x,u)$ var, bu
cezalandýrdýðýmýz faktörlerden biri, yani yüksek olmalarýný tercih
etmiyorum, onlar yüksek olunca $J$ yüksek olacak, dolayýsýyla minimizasyon
onlarýn az olduðu noktalara yönelecek. Mesela $g$ için $u^2$
kullanabilirdim o zaman yüksek $u$ deðerlerini cezalandýrmýþ olurdum. Ya da
orijinden çok uzaklaþmak istemiyorum, o zaman bu mesafeyi cezalandýrýrým,
$g$ için $x^2$ kullanýrým.

$h$ nihai bedel, belki son $T$ anýna gelene kadar ne yaptýðým pek umrumda
deðil, ama son anda orijinden çok uzaða düþmüþ olmayý cezalandýrmak
isteyebilirim, o zaman $h$ için $x^2$ kullanabilirdim. 

Pek çok farklý þey yapmak mümkün. Ama üstteki formun belki de tek
kýsýtlayýcý noktasý formda bir entegral olmasý ve bu entegral bir skalar
bedel $g$'yi entegre ediyor. Yani $x$'in 1 zamaný ve 4 zamanýndaki
çarpýmsal etkilerine deðil toplamsal etkilerine bakýyorum. Entegral
kullanýnca ileride türetimlerde iþlerim kolaylaþýyor tabii, onu seçmemizin
bir sebebi bu. 

Minimum zaman problemi icin bedeli 

$$
g(x,u) = 1, \quad h(x) = 0
$$

olarak seçebilirim, ve $T$ nihai nokta olur, diyelim ki $T$ bize verildi,
yani nihai zaman ani belli, ve $u$ bir $U$ kümesinden geliyor, mesela
$[-1,+1]$. Bu gayet kabul edilebilir bir formülasyon.

Sonra yeni bir dýþ fonksiyon tanýmlýyoruz, bu Hamiltonian, $H$. 

$$
H(x,u,p) = g(x,u) + p(t)^T \left[ x \cdot f(x,u)  \right]
$$

Eðer bir optimal kontrol gidiþ yolu bulduysam, ki bu yol bir dizi $x^*(t),
u^*(t)$ olacak, bu gidiþ yolu alttaki koþullarý yerine getirmeli;

1)

$$
\dot{x}^*(t) = f(x^*, u^*), \quad x^*(0) = x_0
$$

Biraz daha çetrefil bir tane daha var,

2)

$$
\dot{p}(t)
= - \left[ \frac{\partial H}{\partial x}\right]_{x^*(t),u^*(t),p^*(t)}
= -\frac{\partial g^T}{\partial x} \frac{\partial f^T}{\partial x} p(t)
$$

$$
p(T) = \left[ \frac{\partial h}{\partial x} \right]_{x^*(T)}
$$

3)













[devam edecek]

\end{document}
