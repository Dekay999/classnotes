\documentclass[12pt,fleqn]{article}\usepackage{../../common}
\begin{document}
Frekans Filtrelemek

Bir sinyalin içinden belli frekanslarý ayýklama iþlemine filtreleme adý
veriliyor; çeþitleri alçak-geçiren (low-pass), yüksek-geçiren (high-pass),
ve bant geçiren filtreler (band-pass filter). Alçak-geçiren filtrelerle,
mesela 2 kHz üstündeki tüm frekanlarý sinyalden çýkartmak istiyorsak eþik
deðeri 2 kHz'lük olan bir alçak-geçiren filtre kullanabiliriz,
yüksek-geçiren bunun tersini yapar. Bant-geçiren ise sadece belli bir
aralýktaki frekanlara izin vermek için kullanýlýr, mesela sinyalde 4 ve 5
kHz arasý frekanslar kalsýn istiyorsak bir bant geçiren filtre kullanýrýz.

Bu yazýda sonlu dürtü yanýtlý (finite impülse response -FIR-) adý verilen
sayýsal filtreleri kullanacaðýz, bu filtreler tipik olarak sonlu sayýda
katsayý olarak hesaplanýrlar, sonra bur katsayýlar bir evriþim
(convolution) operasyonu ile sinyale uygulanýr.

FIR filtre tasarýmýnda elimizdeki en önemli silah evriþim, ayrýksal fourier
transformu arasýndaki bir iliþki. Eldeki $x$ verisine evriþim ile bir $h$
filtresi uygulayacaðýmýzý düþünelim, ve bu bize $y = x * h$ sonucunu
verecek. Ýliþki þudur ki, eðer $x$ ve $h$'nin Fourier transformunu alýrsak
$x * h$ iþlemi çarpýma dönüþür, yani frekans yöresindeki çarpým iþlemi
zaman yöresindeki evriþim iþlemine eþittir [1, sf. 161]. Yani,

$$ x(n) * h(n) \leftrightarrow X(\theta)H(\theta)$$

ki $X$ ve $H$, $x,h$'nin Fourier transformudur.

Ýspat

Ayrýksal evriþim formülünü hatýrlarsak,

$$ y(n) = x(n) * h(n) = \sum _{m=-\infty}^{\infty} x(m) h(n-m) $$

Eþitliðin iki tarafýnýn Fourier transformunu alalým, $y(n)$'nin transformu
$Y(\theta)$ olsun,

$$  
Y(\theta) =
\sum _{n=-\infty}^{\infty} \bigg[
\sum _{m=-\infty}^{\infty} x(m) h(n-m)
\bigg] e^{-j\theta n}
$$

Toplamlarýn yer deðiþtirebilme özelliðini kullanýrsak, 

$$ 
= \sum _{m=-\infty}^{\infty} x(m)  \sum _{n=-\infty}^{\infty} h(n-m)  e^{-j\theta n}
$$

Þimdi $k = n-m$ tanýmlayalým, 

$$  
= \sum _{m=-\infty}^{\infty} x(m)  \sum _{k=-\infty}^{\infty} h(k)  e^{-j\theta (k+m)}
$$

$$ 
Y(\theta) =
\sum _{m=-\infty}^{\infty} x(m)  e^{-j\theta m}
\sum _{k=-\infty}^{\infty} h(k)  e^{-j\theta k}
$$

Son ifadede $x$ ve $h$ nin ayrý ayrý Fourier transformlarýný elde etmiþ
olduk, ve bu transformlar birbiriyle çarpým halindeler. Ýspat tamamlandý,
gerçekten de evriþtirilen iki öðenin arasýndaki iliþki ayrý ayrý Fourier
transformu üzerinden çarpým haline geliyor.

[devam edecek]

\inputminted[fontsize=\footnotesize]{python}{filt.py}

\begin{minted}[fontsize=\footnotesize]{python}
import filt
fy=300; #signal frequency in Hz
wy=2*np.pi*fy; #signal frequency in rad/s
fs=50; #sampling frequency in Hz
tiv=1./fs; #time interval between samples;
tend = 5 # seconds
t=np.linspace(0,tend,tend/tiv); #time intervals set (5 seconds)

y=0.6*np.sin(wy*t)+0.3*np.sin(3*wy*t)+0.2*np.sin(5*wy*t); #signal data set
f=plt.figure()
plt.plot(t,y)
plt.savefig('compscieng_1_32_05.png')
f=plt.figure()
filt.plotSpectrum(y, fs)
plt.savefig('compscieng_1_32_06.png')

order = 32
fc1 = 1.0
f1 = filt.sinc_filter_low(order, fc1, fs=20).T[0];

y1 = np.convolve(f1, y)
f=plt.figure()
plt.title(u'Alçak Geçiren Filtre Sonrasý Sinyal')
plt.plot(np.arange(len(y1)), y1)
plt.savefig('compscieng_1_32_08.png')

f=plt.figure()
filt.plotSpectrum(y1, fs)
plt.title(u'Alçak Geçiren Filtre Sonrasý Frekanslar')
plt.savefig('compscieng_1_32_07.png')
\end{minted}

\includegraphics[width=20em]{compscieng_1_32_05.png}

\includegraphics[width=20em]{compscieng_1_32_06.png}

\includegraphics[width=20em]{compscieng_1_32_07.png}

\includegraphics[width=20em]{compscieng_1_32_08.png}

\begin{minted}[fontsize=\footnotesize]{python}
fc1 = 4
f2 = filt.sinc_filter_high(order, fc1, fs).T[0];
y2 = np.convolve(f2, y)
f=plt.figure()
plt.plot(np.arange(len(y2)), y2)
plt.title(u'Yüksek Geçiren Filtre Sonrasý Sinyal')
plt.savefig('compscieng_1_32_10.png')
f=plt.figure()
filt.plotSpectrum(y2, fs)
plt.savefig('compscieng_1_32_09.png')
\end{minted}

\includegraphics[width=20em]{compscieng_1_32_09.png}

\includegraphics[width=20em]{compscieng_1_32_10.png}


\begin{minted}[fontsize=\footnotesize]{python}
fc1 = 4.0
fc2 = 4.5
f3 = filt.sinc_filter_band(order, fc1, fc2, fs);
y3 = np.convolve(f3, y)
f=plt.figure()
plt.title(u'Bant Geçiren Filtre Sonrasý Sinyal')
plt.plot(np.arange(len(y3)), y3)
plt.savefig('compscieng_1_32_12.png')
f=plt.figure()
filt.plotSpectrum(y3, fs)
plt.title(u'Bant Geçiren Filtre Sonrasý Frekanslar')
plt.savefig('compscieng_1_32_11.png')
\end{minted}

\includegraphics[width=20em]{compscieng_1_32_11.png}

\includegraphics[width=20em]{compscieng_1_32_12.png}


\begin{minted}[fontsize=\footnotesize]{python}
from scipy.signal import butter, lfilter
def butter_bandpass(lowcut, highcut, fs, order):
    nyq = 0.5 * fs
    low = lowcut / nyq
    high = highcut / nyq
    b, a = butter(order, [low, high], btype='band')
    return b, a

def butter_bandpass_filter(data, lowcut, highcut, fs, order):
    b, a = butter_bandpass(lowcut, highcut, fs, order=order)
    y = lfilter(b, a, data)
    return y

low = 4; high=4.5
yb = butter_bandpass_filter(y, low, high, fs, order=1)
plt.title(u'Bant Geçiren (Butterworth) Filtre Sonrasý Sinyal')
plt.plot(np.arange(len(yb)), yb)
plt.savefig('compscieng_1_32_13.png')
\end{minted}

\includegraphics[width=20em]{compscieng_1_32_13.png}








[devam edecek]

Kaynaklar

[1] ElAli, {\em Discrete Systems and Digital Signal Processing with Matlab, 2nd Edition}

\end{document}
